Sub VBA()
    Dim i As Long
    Dim lastrow As Long
    Dim ws As Worksheet
    Dim Ticker As String
    Dim Summary_Table_Row As Integer
    Dim QuarterlyChange As Double
    Dim PercentChange As Double
    Dim OpeningPrice As Double
    Dim ClosingPrice As Double
    Dim TotalVolume As Double
    Dim Value As Double
    Dim GreatestIncrease As String
    Dim GreatestDecrease As String
    Dim GreatestTotalVolume As String
    Dim MaxVal As Double
    Dim MinVal As Double

    Summary_Table_Row = 2

    For Each ws In ThisWorkbook.Worksheets
        ' Determine the last row of data
        lastrow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
        
        ' Set headers
        ws.Range("I1").Value = "Ticker"
        ws.Range("J1").Value = "Quarterly Change"
        ws.Range("K1").Value = "Percent Change"
        ws.Range("L1").Value = "Total Stock Volume"
        ws.Range("P1").Value = "Ticker"
        ws.Range("Q1").Value = "Value"
        ws.Range("O2").Value = "Greatest % Increase"
        ws.Range("O3").Value = "Greatest % Decrease"
        ws.Range("O4").Value = "Greatest Total Volume"
        
         
        
        ' Initialize variables
        TotalVolume = 0
        OpeningPrice = ws.Cells(2, 3).Value
        
        For i = 2 To lastrow
            ' Accumulate the total volume
            TotalVolume = TotalVolume + ws.Cells(i, 7).Value
            
            ' Check if we have reached the end of a ticker's data
            If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then
                ' Set the ticker name
                Ticker = ws.Cells(i, 1).Value
                ws.Range("I" & Summary_Table_Row).Value = Ticker
                
                ' Set the closing price
                ClosingPrice = ws.Cells(i, 6).Value
                
                ' Calculate the quarterly change
                QuarterlyChange = ClosingPrice - OpeningPrice
                ws.Range("J" & Summary_Table_Row).Value = QuarterlyChange
                
                ' Calculate the percent change
                If OpeningPrice <> 0 Then
                    PercentChange = QuarterlyChange / OpeningPrice
                Else
                    PercentChange = 0
                End If
                ws.Range("K" & Summary_Table_Row).Value = PercentChange
                ws.Range("K" & Summary_Table_Row).NumberFormat = "0.00%"
                
                ' Set the total volume
                ws.Range("L" & Summary_Table_Row).Value = TotalVolume
                
                ' Move to the next smmary table row
                Summary_Table_Row = Summary_Table_Row + 1
                
                ' Reset variables for the next ticker
                TotalVolume = 0
                If i + 1 <= lastrow Then
                    OpeningPrice = ws.Cells(i + 1, 3).Value
                 
              
                MaxVal = Application.WorksheetFunction.Max(ws.Range("K1:K" & lastrow))
                ws.Range("Q2").Value = MaxVal
                ws.Range("Q2").NumberFormat = "0.00%"
        
                MinVal = Application.WorksheetFunction.Min(ws.Range("K1:K" & lastrow))
                ws.Range("Q3").Value = MinVal
                ws.Range("Q3").NumberFormat = "0.00%"
                
                GreatestTotalVolume = Application.WorksheetFunction.Max(ws.Range("L1:L" & lastrow))
                ws.Range("Q4").Value = GreatestTotalVolume
                
                ws.Range("P2").FormulaR1C1 = "=INDEX(C[-7], MATCH(MAX(C[-5]), C[-5], 0))"
                ws.Range("P3").FormulaR1C1 = "=INDEX(C[-7], MATCH(MIN(C[-5]), C[-5], 0))"
                ws.Range("P4").FormulaR1C1 = "=INDEX(C[-7], MATCH(MAX(C[-4]), C[-4], 0))"
    
                End If
            End If
        Next i
        
        ' Reset summary table row for the next worksheet
        Summary_Table_Row = 2
    Next ws
End Sub

 